2020-12-18

设计模式 行为类 备忘录模式

保存一个对象的某个状态，以便于适当的时候恢复对象

意图：在不破坏封装性的前提下，捕获一个对象的内部状态，并在该对象之外保存这个状态

主要解决：所谓备忘录模式就是在不破坏封装的前提下，捕获一个对象的内部结构，并在该对象之外保存对象状态，这样可以在后续进行状态恢复

何时使用：很多时候我们总是需要记录对象内部状态，这样做的目的就是为了允许用户取消不确定或者错误的操作，能够恢复到他原先的状态

如何解决：通过一个备忘录类专门储存对象的状态

关键代码：客户不和备忘录耦合，与备忘录管理类耦合

应用实例：打游戏的存档，window ctrl+z IE的后退 数据库事务管理

优点：给用户提供一种可以恢复状态的机制，可以使用户比较方便回到某个历史状态
实现信息的封装，使得用户不需要更新状态的保存细节

缺点：耗费资源，如果类的成员变量多，势必占用大量资源 而每次保存都消耗一定内存

使用场景：需要保存恢复数据的相关状态场景 2.提供一个可回滚的操作

注意事项：为了符合迪米特原则 还需要添加一个管理备忘录的类
为了节省内存，可以使用原型+备忘录模式